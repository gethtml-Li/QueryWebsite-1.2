{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\src\\views\\ChangePassword.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\src\\views\\ChangePassword.vue","mtime":1620901401924},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmNoYW5nZXBhc3N3b3JkIHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMTAwJTsNCiAgLmVsLWJyZWFkY3J1bWIgew0KICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgfQ0KICAuZWwtY2FyZF9fYm9keSB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICB9DQoNCiAgLmVsLWNhcmQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICAuZWwtY2FyZF9fYm9keSB7DQogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICB3aWR0aDogMTAwJTsNCiAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgIC5mb3JtLWJveCB7DQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgd2lkdGg6IDUwMHB4Ow0KICAgICAgICBoZWlnaHQ6IDQwMHB4Ow0KICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIzMywgMjM2LCAyNDApOw0KICAgICAgICBsZWZ0OiA1MCU7DQogICAgICAgIHRvcDogNTAlOw0KICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgcGFkZGluZzogMzBweCAxMHB4IDMwcHggMTBweDsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7DQogICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYigzOCwgMzUsIDM2KTsNCg0KICAgICAgICAuZWwtZm9ybSB7DQogICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgLmVsLWZvcm0taXRlbV9fbGFiZWwgew0KICAgICAgICAgICAgY29sb3I6IHJnYigxNTksIDAsIDEyNyk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgICAuZm9vdGVyYnV0b24gew0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICAgICAgYnV0dG9uIHsNCiAgICAgICAgICBjb2xvcjogcmdiKDE1OSwgMCwgMTI2KTsNCiAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["ChangePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChangePassword.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"changepassword\">\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item\r\n        v-if=\"username == 'jiaowuchu'\"\r\n        :to=\"{ path: '/superhome' }\"\r\n        >首页</el-breadcrumb-item\r\n      >\r\n      <el-breadcrumb-item v-else :to=\"{ path: '/home/' + $route.params.role }\"\r\n        >首页</el-breadcrumb-item\r\n      >\r\n      <el-breadcrumb-item>下载成绩文件</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <el-card>\r\n      <div class=\"form-box\">\r\n        <el-form\r\n          label-width=\"90px\"\r\n          label-position=\"right\"\r\n          :model=\"formdata\"\r\n          :rules=\"chanpassrulesform\"\r\n          ref=\"chanpassform\"\r\n        >\r\n          <el-form-item label=\"用户名:\">\r\n            <el-input\r\n              size=\"small\"\r\n              v-model=\"formdata.username\"\r\n              disabled\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"旧密码:\" prop=\"password\">\r\n            <el-input\r\n              type=\"password\"\r\n              size=\"small\"\r\n              v-model=\"formdata.password\"\r\n              show-password\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"新密码:\" prop=\"newpass\">\r\n            <el-input\r\n              type=\"password\"\r\n              size=\"small\"\r\n              v-model=\"formdata.newpass\"\r\n              show-password\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"确认新密码:\" prop=\"confirmpass\">\r\n            <el-input\r\n              type=\"password\"\r\n              size=\"small\"\r\n              v-model=\"formdata.confirmpass\"\r\n              show-password\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n\r\n        <div class=\"footerbuton\">\r\n          <el-button @click=\"confirmchangepass\">确定</el-button>\r\n          <el-button @click=\"Reset\">重置</el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    //   旧密码验证函数\r\n    let checkpassword = (rule, value, callback) => {\r\n      if (value == \"\") {\r\n        callback(new Error(\"旧密码不能为空!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    // 新密码验证函数\r\n    let checknewpass = (rule, value, callback) => {\r\n      let rgx = /^[a-zA-Z]\\w{5,17}$/;\r\n      if (value == \"\") {\r\n        callback(new Error(\"新密码不能为空!\"));\r\n      } else {\r\n        if (!rgx.test(value)) {\r\n          callback(\r\n            new Error(\r\n              \"密码请以字母开头，长度在6~18之间，只能包含字母、数字和下划线!\"\r\n            )\r\n          );\r\n        } else {\r\n          callback();\r\n        }\r\n      }\r\n    };\r\n\r\n    // 确认密码验证函数\r\n    let checkconfirmpass = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请再次输入新密码!\"));\r\n      } else if (value !== this.formdata.newpass) {\r\n        callback(new Error(\"两次输入密码不一致!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    return {\r\n      formdata: {\r\n        username: window.sessionStorage.getItem(\"username\"),\r\n        password: \"\",\r\n        newpass: \"\",\r\n        confirmpass: \"\",\r\n      },\r\n      chanpassrulesform: {\r\n        password: [{ validator: checkpassword, trigger: \"blur\" }],\r\n        newpass: [{ validator: checknewpass, trigger: \"blur\" }],\r\n        confirmpass: [{ validator: checkconfirmpass, trigger: \"blur\" }],\r\n      },\r\n      username: window.sessionStorage.getItem(\"username\"),\r\n    };\r\n  },\r\n  methods: {\r\n    // 表单内容重置\r\n    Reset() {\r\n      console.log(this.formdata);\r\n      this.$refs.chanpassform.resetFields();\r\n    },\r\n    //提交修改的密码\r\n    confirmchangepass() {\r\n      this.$refs.chanpassform.validate(async (vali) => {\r\n        console.log(this.formdata);\r\n        if (vali) {\r\n          console.log(this.formdata);\r\n          let data = (\r\n            await axios.post(\"/uppassword\", {\r\n              ...this.formdata,\r\n            })\r\n          ).data;\r\n          console.log(data);\r\n          if (data.meta.status == 200) {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"修改密码成功\",\r\n            });\r\n            this.$alert(\"修改密码成功，请退出重新登入\", \"提示\", {\r\n              confirmButtonText: \"确定\",\r\n              type: \"success\",\r\n              showClose: false,\r\n              callback: () => {\r\n                window.sessionStorage.clear();\r\n                console.log(15454);\r\n                this.$router.replace(\"/\");\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"退出成功\",\r\n                });\r\n              },\r\n            });\r\n          } else if (data.meta.status == 300) {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: \"旧密码错误,修改密码失败\",\r\n            });\r\n          } else if (data.meta.status == 404) {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: \"修改密码失败,服务器发生未知错误\",\r\n            });\r\n          }\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.changepassword {\r\n  width: 100%;\r\n  height: 100%;\r\n  .el-breadcrumb {\r\n    margin-bottom: 5px;\r\n  }\r\n  .el-card__body {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .el-card {\r\n    width: 100%;\r\n    height: 100%;\r\n    .el-card__body {\r\n      position: relative;\r\n      width: 100%;\r\n      height: 100%;\r\n      .form-box {\r\n        position: absolute;\r\n        width: 500px;\r\n        height: 400px;\r\n        background-color: rgba(233, 236, 240);\r\n        left: 50%;\r\n        top: 50%;\r\n        transform: translate(-50%, -50%);\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        padding: 30px 10px 30px 10px;\r\n        justify-content: space-around;\r\n        border-radius: 10px;\r\n        box-shadow: 0 0 10px rgb(38, 35, 36);\r\n\r\n        .el-form {\r\n          width: 100%;\r\n          .el-form-item__label {\r\n            color: rgb(159, 0, 127);\r\n          }\r\n        }\r\n      }\r\n      .footerbuton {\r\n        width: 100%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        button {\r\n          color: rgb(159, 0, 126);\r\n          font-weight: bold;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}