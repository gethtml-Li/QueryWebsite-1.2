{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\src\\views\\ChangePassword.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\src\\views\\ChangePassword.vue","mtime":1620901401924},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\QueryWebsite-1.2\\fore-end\\studentadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgLy8gICDml6flr4bnoIHpqozor4Hlh73mlbANCiAgICBsZXQgY2hlY2twYXNzd29yZCA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICh2YWx1ZSA9PSAiIikgew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuaXp+WvhueggeS4jeiDveS4uuepuiEiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfQ0KICAgIH07DQoNCiAgICAvLyDmlrDlr4bnoIHpqozor4Hlh73mlbANCiAgICBsZXQgY2hlY2tuZXdwYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgbGV0IHJneCA9IC9eW2EtekEtWl1cd3s1LDE3fSQvOw0KICAgICAgaWYgKHZhbHVlID09ICIiKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5paw5a+G56CB5LiN6IO95Li656m6ISIpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlmICghcmd4LnRlc3QodmFsdWUpKSB7DQogICAgICAgICAgY2FsbGJhY2soDQogICAgICAgICAgICBuZXcgRXJyb3IoDQogICAgICAgICAgICAgICLlr4bnoIHor7fku6XlrZfmr43lvIDlpLTvvIzplb/luqblnKg2fjE45LmL6Ze077yM5Y+q6IO95YyF5ZCr5a2X5q+N44CB5pWw5a2X5ZKM5LiL5YiS57q/ISINCiAgICAgICAgICAgICkNCiAgICAgICAgICApOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGNhbGxiYWNrKCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9Ow0KDQogICAgLy8g56Gu6K6k5a+G56CB6aqM6K+B5Ye95pWwDQogICAgbGV0IGNoZWNrY29uZmlybXBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQogICAgICBpZiAodmFsdWUgPT09ICIiKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+35YaN5qyh6L6T5YWl5paw5a+G56CBISIpKTsNCiAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IHRoaXMuZm9ybWRhdGEubmV3cGFzcykgew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuS4pOasoei+k+WFpeWvhueggeS4jeS4gOiHtCEiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfQ0KICAgIH07DQoNCiAgICByZXR1cm4gew0KICAgICAgZm9ybWRhdGE6IHsNCiAgICAgICAgdXNlcm5hbWU6IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VybmFtZSIpLA0KICAgICAgICBwYXNzd29yZDogIiIsDQogICAgICAgIG5ld3Bhc3M6ICIiLA0KICAgICAgICBjb25maXJtcGFzczogIiIsDQogICAgICB9LA0KICAgICAgY2hhbnBhc3NydWxlc2Zvcm06IHsNCiAgICAgICAgcGFzc3dvcmQ6IFt7IHZhbGlkYXRvcjogY2hlY2twYXNzd29yZCwgdHJpZ2dlcjogImJsdXIiIH1dLA0KICAgICAgICBuZXdwYXNzOiBbeyB2YWxpZGF0b3I6IGNoZWNrbmV3cGFzcywgdHJpZ2dlcjogImJsdXIiIH1dLA0KICAgICAgICBjb25maXJtcGFzczogW3sgdmFsaWRhdG9yOiBjaGVja2NvbmZpcm1wYXNzLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICB9LA0KICAgICAgdXNlcm5hbWU6IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VybmFtZSIpLA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDooajljZXlhoXlrrnph43nva4NCiAgICBSZXNldCgpIHsNCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybWRhdGEpOw0KICAgICAgdGhpcy4kcmVmcy5jaGFucGFzc2Zvcm0ucmVzZXRGaWVsZHMoKTsNCiAgICB9LA0KICAgIC8v5o+Q5Lqk5L+u5pS555qE5a+G56CBDQogICAgY29uZmlybWNoYW5nZXBhc3MoKSB7DQogICAgICB0aGlzLiRyZWZzLmNoYW5wYXNzZm9ybS52YWxpZGF0ZShhc3luYyAodmFsaSkgPT4gew0KICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmZvcm1kYXRhKTsNCiAgICAgICAgaWYgKHZhbGkpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmZvcm1kYXRhKTsNCiAgICAgICAgICBsZXQgZGF0YSA9ICgNCiAgICAgICAgICAgIGF3YWl0IGF4aW9zLnBvc3QoIi91cHBhc3N3b3JkIiwgew0KICAgICAgICAgICAgICAuLi50aGlzLmZvcm1kYXRhLA0KICAgICAgICAgICAgfSkNCiAgICAgICAgICApLmRhdGE7DQogICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7DQogICAgICAgICAgaWYgKGRhdGEubWV0YS5zdGF0dXMgPT0gMjAwKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLA0KICAgICAgICAgICAgICBtZXNzYWdlOiAi5L+u5pS55a+G56CB5oiQ5YqfIiwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdGhpcy4kYWxlcnQoIuS/ruaUueWvhueggeaIkOWKn++8jOivt+mAgOWHuumHjeaWsOeZu+WFpSIsICLmj5DnpLoiLCB7DQogICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwNCiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLA0KICAgICAgICAgICAgICBzaG93Q2xvc2U6IGZhbHNlLA0KICAgICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gew0KICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5jbGVhcigpOw0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDE1NDU0KTsNCiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSgiLyIpOw0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLA0KICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIumAgOWHuuaIkOWKnyIsDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEubWV0YS5zdGF0dXMgPT0gMzAwKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgICAgbWVzc2FnZTogIuaXp+WvhueggemUmeivryzkv67mlLnlr4bnoIHlpLHotKUiLA0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLm1ldGEuc3RhdHVzID09IDQwNCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgICAgICAgIG1lc3NhZ2U6ICLkv67mlLnlr4bnoIHlpLHotKUs5pyN5Yqh5Zmo5Y+R55Sf5pyq55+l6ZSZ6K+vIiwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["ChangePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChangePassword.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"changepassword\">\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item\r\n        v-if=\"username == 'jiaowuchu'\"\r\n        :to=\"{ path: '/superhome' }\"\r\n        >首页</el-breadcrumb-item\r\n      >\r\n      <el-breadcrumb-item v-else :to=\"{ path: '/home/' + $route.params.role }\"\r\n        >首页</el-breadcrumb-item\r\n      >\r\n      <el-breadcrumb-item>下载成绩文件</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <el-card>\r\n      <div class=\"form-box\">\r\n        <el-form\r\n          label-width=\"90px\"\r\n          label-position=\"right\"\r\n          :model=\"formdata\"\r\n          :rules=\"chanpassrulesform\"\r\n          ref=\"chanpassform\"\r\n        >\r\n          <el-form-item label=\"用户名:\">\r\n            <el-input\r\n              size=\"small\"\r\n              v-model=\"formdata.username\"\r\n              disabled\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"旧密码:\" prop=\"password\">\r\n            <el-input\r\n              type=\"password\"\r\n              size=\"small\"\r\n              v-model=\"formdata.password\"\r\n              show-password\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"新密码:\" prop=\"newpass\">\r\n            <el-input\r\n              type=\"password\"\r\n              size=\"small\"\r\n              v-model=\"formdata.newpass\"\r\n              show-password\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"确认新密码:\" prop=\"confirmpass\">\r\n            <el-input\r\n              type=\"password\"\r\n              size=\"small\"\r\n              v-model=\"formdata.confirmpass\"\r\n              show-password\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n\r\n        <div class=\"footerbuton\">\r\n          <el-button @click=\"confirmchangepass\">确定</el-button>\r\n          <el-button @click=\"Reset\">重置</el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    //   旧密码验证函数\r\n    let checkpassword = (rule, value, callback) => {\r\n      if (value == \"\") {\r\n        callback(new Error(\"旧密码不能为空!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    // 新密码验证函数\r\n    let checknewpass = (rule, value, callback) => {\r\n      let rgx = /^[a-zA-Z]\\w{5,17}$/;\r\n      if (value == \"\") {\r\n        callback(new Error(\"新密码不能为空!\"));\r\n      } else {\r\n        if (!rgx.test(value)) {\r\n          callback(\r\n            new Error(\r\n              \"密码请以字母开头，长度在6~18之间，只能包含字母、数字和下划线!\"\r\n            )\r\n          );\r\n        } else {\r\n          callback();\r\n        }\r\n      }\r\n    };\r\n\r\n    // 确认密码验证函数\r\n    let checkconfirmpass = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请再次输入新密码!\"));\r\n      } else if (value !== this.formdata.newpass) {\r\n        callback(new Error(\"两次输入密码不一致!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    return {\r\n      formdata: {\r\n        username: window.sessionStorage.getItem(\"username\"),\r\n        password: \"\",\r\n        newpass: \"\",\r\n        confirmpass: \"\",\r\n      },\r\n      chanpassrulesform: {\r\n        password: [{ validator: checkpassword, trigger: \"blur\" }],\r\n        newpass: [{ validator: checknewpass, trigger: \"blur\" }],\r\n        confirmpass: [{ validator: checkconfirmpass, trigger: \"blur\" }],\r\n      },\r\n      username: window.sessionStorage.getItem(\"username\"),\r\n    };\r\n  },\r\n  methods: {\r\n    // 表单内容重置\r\n    Reset() {\r\n      console.log(this.formdata);\r\n      this.$refs.chanpassform.resetFields();\r\n    },\r\n    //提交修改的密码\r\n    confirmchangepass() {\r\n      this.$refs.chanpassform.validate(async (vali) => {\r\n        console.log(this.formdata);\r\n        if (vali) {\r\n          console.log(this.formdata);\r\n          let data = (\r\n            await axios.post(\"/uppassword\", {\r\n              ...this.formdata,\r\n            })\r\n          ).data;\r\n          console.log(data);\r\n          if (data.meta.status == 200) {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"修改密码成功\",\r\n            });\r\n            this.$alert(\"修改密码成功，请退出重新登入\", \"提示\", {\r\n              confirmButtonText: \"确定\",\r\n              type: \"success\",\r\n              showClose: false,\r\n              callback: () => {\r\n                window.sessionStorage.clear();\r\n                console.log(15454);\r\n                this.$router.replace(\"/\");\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"退出成功\",\r\n                });\r\n              },\r\n            });\r\n          } else if (data.meta.status == 300) {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: \"旧密码错误,修改密码失败\",\r\n            });\r\n          } else if (data.meta.status == 404) {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: \"修改密码失败,服务器发生未知错误\",\r\n            });\r\n          }\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.changepassword {\r\n  width: 100%;\r\n  height: 100%;\r\n  .el-breadcrumb {\r\n    margin-bottom: 5px;\r\n  }\r\n  .el-card__body {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .el-card {\r\n    width: 100%;\r\n    height: 100%;\r\n    .el-card__body {\r\n      position: relative;\r\n      width: 100%;\r\n      height: 100%;\r\n      .form-box {\r\n        position: absolute;\r\n        width: 500px;\r\n        height: 400px;\r\n        background-color: rgba(233, 236, 240);\r\n        left: 50%;\r\n        top: 50%;\r\n        transform: translate(-50%, -50%);\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        padding: 30px 10px 30px 10px;\r\n        justify-content: space-around;\r\n        border-radius: 10px;\r\n        box-shadow: 0 0 10px rgb(38, 35, 36);\r\n\r\n        .el-form {\r\n          width: 100%;\r\n          .el-form-item__label {\r\n            color: rgb(159, 0, 127);\r\n          }\r\n        }\r\n      }\r\n      .footerbuton {\r\n        width: 100%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        button {\r\n          color: rgb(159, 0, 126);\r\n          font-weight: bold;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}